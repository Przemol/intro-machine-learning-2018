# Solutions ch. 8 - Artificial neural networks {#solutions-ann}

Solutions to exercises of chapter \@ref(ann).

## Exercise 1


```r
library("neuralnet")
 
#To create a neural network to perform square root

#Generate 50 random numbers uniformly distributed between 0 and 100
#And store them as a dataframe
traininginput <-  as.data.frame(runif(50, min=0, max=100))
trainingoutput <- sqrt(traininginput)
 
#Column bind the data into one variable
trainingdata <- cbind(traininginput,trainingoutput)
colnames(trainingdata) <- c("Input","Output")
 
#Train the neural network
#Will have 10 hidden layers
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqrt <- neuralnet(Output~Input,trainingdata, hidden=10, threshold=0.01)
print(net.sqrt)
```

```
## $call
## neuralnet(formula = Output ~ Input, data = trainingdata, hidden = 10, 
##     threshold = 0.01)
## 
## $response
##         Output
## 1  4.650652925
## 2  8.923638234
## 3  8.448789585
## 4  4.168640656
## 5  8.900760766
## 6  5.384843188
## 7  9.570884348
## 8  6.225784147
## 9  7.984924022
## 10 7.242217891
## 11 9.488462629
## 12 9.732712333
## 13 6.779660980
## 14 6.138584381
## 15 8.948039984
## 16 3.442467797
## 17 3.693762364
## 18 9.933274484
## 19 4.542892960
## 20 5.889255143
## 21 9.985393494
## 22 9.670319940
## 23 3.960295653
## 24 6.015815469
## 25 5.883776548
## 26 6.948547770
## 27 8.889758147
## 28 7.668086024
## 29 7.781620511
## 30 5.429912001
## 31 9.806812289
## 32 1.362837521
## 33 3.600222956
## 34 7.151275948
## 35 2.990897205
## 36 2.912449549
## 37 9.245419765
## 38 8.680646694
## 39 9.105665043
## 40 6.936031616
## 41 6.542666754
## 42 3.498571346
## 43 8.484677820
## 44 6.883838589
## 45 6.485562641
## 46 9.030367186
## 47 4.014340180
## 48 5.511068978
## 49 8.083418835
## 50 9.747987120
## 
## $covariate
##               [,1]
##  [1,] 21.628572629
##  [2,] 79.631319339
##  [3,] 71.382045443
##  [4,] 17.377564916
##  [5,] 79.223542218
##  [6,] 28.996536159
##  [7,] 91.601827205
##  [8,] 38.760388247
##  [9,] 63.759011636
## [10,] 52.449719980
## [11,] 90.030923067
## [12,] 94.725689362
## [13,] 45.963803004
## [14,] 37.682218198
## [15,] 80.067419563
## [16,] 11.850584531
## [17,] 13.643880398
## [18,] 98.669941979
## [19,] 20.637876447
## [20,] 34.683326143
## [21,] 99.708083225
## [22,] 93.515087734
## [23,] 15.683941660
## [24,] 36.190035753
## [25,] 34.618826467
## [26,] 48.282316118
## [27,] 79.027799913
## [28,] 58.799543278
## [29,] 60.553617775
## [30,] 29.483944341
## [31,] 96.173567278
## [32,]  1.857326110
## [33,] 12.961605331
## [34,] 51.140747685
## [35,]  8.945466089
## [36,]  8.482362377
## [37,] 85.477786628
## [38,] 75.353627023
## [39,] 82.913135877
## [40,] 48.108534585
## [41,] 42.806488252
## [42,] 12.240001466
## [43,] 71.989757707
## [44,] 47.387233726
## [45,] 42.062522774
## [46,] 81.547531509
## [47,] 16.114927083
## [48,] 30.371881276
## [49,] 65.341660054
## [50,] 95.023252885
## 
## $model.list
## $model.list$response
## [1] "Output"
## 
## $model.list$variables
## [1] "Input"
## 
## 
## $err.fct
## function (x, y) 
## {
##     1/2 * (y - x)^2
## }
## <environment: 0x3cdca00>
## attr(,"type")
## [1] "sse"
## 
## $act.fct
## function (x) 
## {
##     1/(1 + exp(-x))
## }
## <environment: 0x3cdca00>
## attr(,"type")
## [1] "logistic"
## 
## $linear.output
## [1] TRUE
## 
## $data
##           Input      Output
## 1  21.628572629 4.650652925
## 2  79.631319339 8.923638234
## 3  71.382045443 8.448789585
## 4  17.377564916 4.168640656
## 5  79.223542218 8.900760766
## 6  28.996536159 5.384843188
## 7  91.601827205 9.570884348
## 8  38.760388247 6.225784147
## 9  63.759011636 7.984924022
## 10 52.449719980 7.242217891
## 11 90.030923067 9.488462629
## 12 94.725689362 9.732712333
## 13 45.963803004 6.779660980
## 14 37.682218198 6.138584381
## 15 80.067419563 8.948039984
## 16 11.850584531 3.442467797
## 17 13.643880398 3.693762364
## 18 98.669941979 9.933274484
## 19 20.637876447 4.542892960
## 20 34.683326143 5.889255143
## 21 99.708083225 9.985393494
## 22 93.515087734 9.670319940
## 23 15.683941660 3.960295653
## 24 36.190035753 6.015815469
## 25 34.618826467 5.883776548
## 26 48.282316118 6.948547770
## 27 79.027799913 8.889758147
## 28 58.799543278 7.668086024
## 29 60.553617775 7.781620511
## 30 29.483944341 5.429912001
## 31 96.173567278 9.806812289
## 32  1.857326110 1.362837521
## 33 12.961605331 3.600222956
## 34 51.140747685 7.151275948
## 35  8.945466089 2.990897205
## 36  8.482362377 2.912449549
## 37 85.477786628 9.245419765
## 38 75.353627023 8.680646694
## 39 82.913135877 9.105665043
## 40 48.108534585 6.936031616
## 41 42.806488252 6.542666754
## 42 12.240001466 3.498571346
## 43 71.989757707 8.484677820
## 44 47.387233726 6.883838589
## 45 42.062522774 6.485562641
## 46 81.547531509 9.030367186
## 47 16.114927083 4.014340180
## 48 30.371881276 5.511068978
## 49 65.341660054 8.083418835
## 50 95.023252885 9.747987120
## 
## $net.result
## $net.result[[1]]
##           [,1]
## 1  4.639171158
## 2  8.928422920
## 3  8.441239081
## 4  4.165134484
## 5  8.904930602
## 6  5.378599351
## 7  9.579655261
## 8  6.232611168
## 9  7.972449742
## 10 7.239208275
## 11 9.499148053
## 12 9.734439436
## 13 6.784588224
## 14 6.144736019
## 15 8.953468594
## 16 3.450160120
## 17 3.700299828
## 18 9.918999385
## 19 4.532461855
## 20 5.892235073
## 21 9.965444307
## 22 9.675322164
## 23 3.961710625
## 24 6.020613656
## 25 5.886669543
## 26 6.950988645
## 27 8.893629054
## 28 7.657759093
## 29 7.770074464
## 30 5.424483963
## 31 9.803646864
## 32 1.364237351
## 33 3.607745435
## 34 7.150034441
## 35 2.985295816
## 36 2.902325327
## 37 9.256681554
## 38 8.678731446
## 39 9.114779940
## 40 6.938678984
## 41 6.549708711
## 42 3.506444466
## 43 8.477894559
## 44 6.887311791
## 45 6.492831679
## 46 9.037843976
## 47 4.014489523
## 48 5.507160722
## 49 8.071155411
## 50 9.748797402
## 
## 
## $weights
## $weights[[1]]
## $weights[[1]][[1]]
##               [,1]          [,2]           [,3]        [,4]           [,5]
## [1,] 0.77387472978 0.31479110798  1.52271802327 11.58781093 -1.02597917572
## [2,] 0.04720780174 0.04663987614 -0.05486201138 13.64884119  0.06407370575
##                [,6]           [,7]          [,8]           [,9]
## [1,]  0.17836501286 -0.09053207998 -2.1681732230 -0.01492673315
## [2,] -0.06538226073 -0.05091397565 -0.0332607273 -0.23956493765
##               [,10]
## [1,] -3.37799374580
## [2,]  0.04234959051
## 
## $weights[[1]][[2]]
##                [,1]
##  [1,]  3.3899374496
##  [2,]  1.0966379334
##  [3,]  0.5218485326
##  [4,] -1.0123409604
##  [5,] -0.5971434506
##  [6,]  2.3464018313
##  [7,] -1.3011657414
##  [8,] -1.2179373469
##  [9,] -1.3345865839
## [10,] -3.0645734164
## [11,]  4.6619976521
## 
## 
## 
## $startweights
## $startweights[[1]]
## $startweights[[1]][[1]]
##               [,1]         [,2]          [,3]          [,4]          [,5]
## [1,] 1.05283222373 0.2043286450  0.6250367441 -1.9286964196 -0.1006828517
## [2,] 0.02769266595 0.4527070158 -0.9062836873  0.6639338378  0.5560540522
##                [,6]          [,7]          [,8]         [,9]        [,10]
## [1,] -0.50780656350 -0.7800680699 -1.9490754061 -1.191573225 -1.645629450
## [2,] -0.08078735162 -0.5332214318  0.4954847711 -1.650305137  1.167734548
## 
## $startweights[[1]][[2]]
##                 [,1]
##  [1,]  2.35703879702
##  [2,] -0.04445308247
##  [3,] -0.30548349368
##  [4,] -0.13980956714
##  [5,] -1.63004210321
##  [6,]  1.19673857143
##  [7,] -0.46999292255
##  [8,] -0.58554248103
##  [9,] -1.78308557451
## [10,]  0.84236851235
## [11,]  1.53505404138
## 
## 
## 
## $generalized.weights
## $generalized.weights[[1]]
##                [,1]
## 1  -0.0063209542701
## 2  -0.0008126273718
## 3  -0.0009616876088
## 4  -0.0088872629469
## 5  -0.0008196319329
## 6  -0.0040129023947
## 7  -0.0006168333941
## 8  -0.0024780539262
## 9  -0.0011263143780
## 10 -0.0014986997064
## 11 -0.0006414970721
## 12 -0.0005688636067
## 13 -0.0018555277485
## 14 -0.0026001473876
## 15 -0.0008051658320
## 16 -0.0172811616103
## 17 -0.0133649788464
## 18 -0.0005106500074
## 19 -0.0067914745803
## 20 -0.0029918209829
## 21 -0.0004958209008
## 22 -0.0005872737654
## 23 -0.0105117443712
## 24 -0.0027848107511
## 25 -0.0030011825174
## 26 -0.0017106499755
## 27 -0.0008230040884
## 28 -0.0012627885221
## 29 -0.0012108199042
## 30 -0.0039071618401
## 31 -0.0005471668846
## 32 -0.5587001507564
## 33 -0.0146529295693
## 34 -0.0015593902329
## 35 -0.0297241290472
## 36 -0.0330029407548
## 37 -0.0007147745317
## 38 -0.0008876849946
## 39 -0.0007571528503
## 40 -0.0017207686170
## 41 -0.0020919558760
## 42 -0.0162730051191
## 43 -0.0009500012473
## 44 -0.0017640055594
## 45 -0.0021552818366
## 46 -0.0007800540660
## 47 -0.0100485386060
## 48 -0.0037245927914
## 49 -0.0010886247664
## 50 -0.0005643752510
## 
## 
## $result.matrix
##                                        1
## error                     0.001408393390
## reached.threshold         0.009762923679
## steps                  2461.000000000000
## Intercept.to.1layhid1     0.773874729782
## Input.to.1layhid1         0.047207801738
## Intercept.to.1layhid2     0.314791107977
## Input.to.1layhid2         0.046639876141
## Intercept.to.1layhid3     1.522718023268
## Input.to.1layhid3        -0.054862011377
## Intercept.to.1layhid4    11.587810931932
## Input.to.1layhid4        13.648841189335
## Intercept.to.1layhid5    -1.025979175724
## Input.to.1layhid5         0.064073705754
## Intercept.to.1layhid6     0.178365012862
## Input.to.1layhid6        -0.065382260726
## Intercept.to.1layhid7    -0.090532079984
## Input.to.1layhid7        -0.050913975645
## Intercept.to.1layhid8    -2.168173222985
## Input.to.1layhid8        -0.033260727305
## Intercept.to.1layhid9    -0.014926733151
## Input.to.1layhid9        -0.239564937652
## Intercept.to.1layhid10   -3.377993745800
## Input.to.1layhid10        0.042349590506
## Intercept.to.Output       3.389937449581
## 1layhid.1.to.Output       1.096637933397
## 1layhid.2.to.Output       0.521848532609
## 1layhid.3.to.Output      -1.012340960397
## 1layhid.4.to.Output      -0.597143450648
## 1layhid.5.to.Output       2.346401831303
## 1layhid.6.to.Output      -1.301165741409
## 1layhid.7.to.Output      -1.217937346888
## 1layhid.8.to.Output      -1.334586583940
## 1layhid.9.to.Output      -3.064573416440
## 1layhid.10.to.Output      4.661997652090
## 
## attr(,"class")
## [1] "nn"
```

```r
#Plot the neural network
plot(net.sqrt)
 
#Test the neural network on some training data
testdata <- as.data.frame((1:10)^2) #Generate some squared numbers
net.results <- compute(net.sqrt, testdata) #Run them through the neural network
 
#See what properties net.sqrt has
ls(net.results)
```

```
## [1] "net.result" "neurons"
```

```r
#see the results
print(net.results$net.result)
```

```
##              [,1]
##  [1,] 1.123602088
##  [2,] 1.933628967
##  [3,] 2.994884003
##  [4,] 4.000488144
##  [5,] 4.988594968
##  [6,] 6.004592623
##  [7,] 7.001561336
##  [8,] 7.987528762
##  [9,] 9.006747280
## [10,] 9.978339605
```

```r
#Display a better version of the results
cleanoutput <- cbind(testdata,sqrt(testdata),
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
print(cleanoutput)
```

```
##    Input Expected Output Neural Net Output
## 1      1               1       1.123602088
## 2      4               2       1.933628967
## 3      9               3       2.994884003
## 4     16               4       4.000488144
## 5     25               5       4.988594968
## 6     36               6       6.004592623
## 7     49               7       7.001561336
## 8     64               8       7.987528762
## 9     81               9       9.006747280
## 10   100              10       9.978339605
```

*Acknowledgement: this example excercise was from* http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/ 

